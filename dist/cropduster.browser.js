var CD=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o="callbacks are deprecated in cropduster, prefer using promises for asynchronous operations",a={CORS_PROXY_SERVER:"http://cors.movableink.com",$:function(e,t){return t||(t=document),[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t.querySelectorAll(e)))},_initParams:function(){a._urlParams={};for(var e=/([^&=]+)=?([^&]*)/g,t=a._searchString(),n=e.exec(t);n;)a._urlParams[decodeURIComponent(n[1])]=decodeURIComponent(n[2]),n=e.exec(t)},param:function(e){return a.params()[e]},params:function(e){var t=a._urlParams;return void 0===t&&(a._initParams(),t=a._urlParams),e?t[e]:t},_searchString:function(){return window.location.search.substring(1)},autofill:function(){a.param("init");var e=a._urlParams;for(var t in e)"undefined"!==e[t]&&e[t].length>0&&document.getElementById("autofill_"+t)&&(document.getElementById("autofill_"+t).innerHTML=e[t])},throwError:function(e){a.miCaptureFallback(function(){MICapture.error(e)},function(){a.log("Capturama error: "+e)})},cancelRequest:function(e){a.miCaptureFallback(function(){MICapture.cancel(e)},function(){a.log("Request canceled: "+e)})},setImageRedirect:function(e){var t=document.getElementById("mi-redirect-image")||document.createElement("a");return t.href=e,t.id="mi-redirect-image",t.style.display="none",document.body.appendChild(t),t},setClickthrough:function(e){var t=document.getElementById("mi_dynamic_link")||document.createElement("a");return t.href=e,t.id="mi_dynamic_link",t.style.display="none",document.body.appendChild(t),t},setExtraData:function(e){var t=document.getElementById("mi-data")||document.createElement("div");t.id="mi-data",t.style.display="none";var n=void 0;try{n=JSON.parse(t.getAttribute("data-mi-data"))||{}}catch(e){n={}}for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return t.setAttribute("data-mi-data",JSON.stringify(n)),document.body.appendChild(t),t},proxyUrl:function(e){var t=document.createElement("a");t.href=e;var n="";n="0"===t.port||""===t.port?"https:"===t.protocol?":443":"":":"+t.port;var r=t.hostname,o=t.pathname,u=t.search,i=t.hash;return a.CORS_PROXY_SERVER+"/"+r+n+o+u+i},_readyToCapture:!0,_reset:function(){a._readyToCapture=!0},pause:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"manual suspension";e&&(t+=", will end in "+e+"ms",setTimeout(function(){a.resume(t)},e)),a.miCaptureFallback(function(){MICapture.pause(t)},function(){a.log("paused: "+t)})},resume:function(e){a.miCaptureFallback(function(){MICapture.resume(e)},function(){a.log("resuming paused capture: "+e)})},getCORS:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];return"function"==typeof t&&(n=t,t={}),t.corsCacheTime=t.corsCacheTime||1e4,/cors.movableink.com/.test(e)||(e=a.proxyUrl(e)),t.headers=t.headers||{},t.headers["x-reverse-proxy-ttl"]=t.corsCacheTime/1e3,t.headers["x-mi-cbe"]=this._hashForRequest(e,t),a.get(e,t,n)},get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];"function"==typeof t&&(n=t,t={});var r=function(){if(n&&"function"==typeof n)return a.log(o),n.apply(void 0,arguments)},u="xhr: "+e;return new Promise(function(n,o){try{var i=new XMLHttpRequest;if(i.onerror=function(){var t=this.statusText;a.resume(u),a.log("XHR error for "+e+" - "+status+": "+t),r(null),o({status:status,statusText:t})},i.onload=function(){a.resume(u);var e=this.getResponseHeader("content-type"),t=this.responseText,o=this.status;r(t,o,e),n({contentType:e,data:t,status:o})},i.open(t.method||"GET",e,!0),i.withCredentials=!0,t.headers)for(var s in t.headers)i.setRequestHeader(s,t.headers[s]);i.send(t.body),a.pause(t.maxSuspension,u)}catch(e){r(null),o({message:"Cropduster failed to create Promise: "+e,error:e})}})},getImage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];"function"==typeof t&&(n=t,t={});var r=function(){if(n&&"function"==typeof n)return a.log(o),n.apply(void 0,arguments)},u="getImage: "+e;return new Promise(function(n,o){var i=new Image;i.onload=function(){a.resume(u),r(i),n(i)},i.onerror=function(e){a.resume(u),r(null),o(e)},a.pause(t.maxSuspension,u),i.src=e})},getImages:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=arguments[2],u=arguments[3],i="getImages:";a.pause(t.maxSuspension,i),"function"==typeof t&&(u=r,r=t,t={});var s=e.map(function(e){return n.getImage(e,t.maxSuspension).then(function(e){return r&&r(e),e})});return Promise.all(s).then(function(e){return u&&(a.log(o),u(e)),a.resume(i),e},function(e){throw a.resume(i),new Error("Not all images loaded successfully")})},waitForAsset:function(e){a.miCaptureFallback(function(){MICapture.waitForAsset(e)},function(){a.log("Wait for asset: "+e)})},log:function(e){console.log(e)},miCaptureFallback:function(e,t){return!!MICapture&&"object"===("undefined"==typeof MICapture?"undefined":r(MICapture))?e():t()},_hashForRequest:function(e,t){var n=""+e+JSON.stringify(t),r=0;if(0===n.length)return r;for(var o=0;o<n.length;o++)r=(r<<5)-r+n.charCodeAt(o)&4294967295;return r.toString()}};t.default=a,e.exports=t.default}]);
//# sourceMappingURL=cropduster.browser.js.map