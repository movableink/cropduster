{"version":3,"sources":["webpack:///cropduster.browser.js","webpack:///webpack/bootstrap 13b9ee4e72a56a8bdc81","webpack:///./src/cropduster.js"],"names":["CD","modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_toConsumableArray","arr","Array","isArray","arr2","length","from","value","_typeof","Symbol","iterator","obj","constructor","DEPRECATION_MSG","CORS_PROXY_SERVER","$","selector","doc","document","concat","querySelectorAll","_initParams","_urlParams","search","query","_searchString","match","exec","decodeURIComponent","param","params","window","location","substring","autofill","key","getElementById","innerHTML","throwError","msg","miCaptureFallback","MICapture","error","log","cancelRequest","cancel","setImageRedirect","imageUrl","a","createElement","href","id","style","display","body","appendChild","setClickthrough","url","setExtraData","dataObject","el","existingData","JSON","parse","getAttribute","_","setAttribute","stringify","proxyUrl","port","protocol","hostname","pathname","hash","_readyToCapture","_reset","pause","maxSuspension","arguments","undefined","setTimeout","resume","getCORS","options","callback","corsCacheTime","test","headers","this","_hashForRequest","deprecatedCallback","Promise","resolve","reject","req","XMLHttpRequest","onerror","status","statusText","Error","onload","contentType","getResponseHeader","data","responseText","open","method","withCredentials","withoutCredentials","header","setRequestHeader","send","message","getImage","img","Image","event","src","getImages","urls","_this","afterEach","afterAll","promises","map","then","all","images","waitForAsset","assetUrl","console","ifCapturama","ifBrowser","str","charCodeAt","toString","default"],"mappings":"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","file":"cropduster.browser.js","sourcesContent":["var CD =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar DEPRECATION_MSG = 'callbacks are deprecated in cropduster, prefer using promises for asynchronous operations';\n\nvar CD = {\n  CORS_PROXY_SERVER: 'http://cors.movableink.com',\n\n  $: function $(selector, doc) {\n    if (!doc) {\n      doc = document;\n    }\n\n    return [].concat(_toConsumableArray(doc.querySelectorAll(selector)));\n  },\n  _initParams: function _initParams() {\n    CD._urlParams = {};\n    var search = /([^&=]+)=?([^&]*)/g;\n    var query = CD._searchString();\n\n    var match = search.exec(query);\n    while (match) {\n      CD._urlParams[decodeURIComponent(match[1])] = decodeURIComponent(match[2]);\n      match = search.exec(query);\n    }\n  },\n  param: function param(name) {\n    return CD.params()[name];\n  },\n  params: function params(name) {\n    var params = CD._urlParams;\n    if (typeof params === 'undefined') {\n      CD._initParams();\n      params = CD._urlParams;\n    }\n\n    if (name) {\n      return params[name];\n    } else {\n      return params;\n    }\n  },\n  _searchString: function _searchString() {\n    return window.location.search.substring(1);\n  },\n  autofill: function autofill() {\n    CD.param('init'); // inits CD._urlParams\n    var params = CD._urlParams;\n    for (var key in params) {\n      if (params[key] !== 'undefined' && params[key].length > 0) {\n        if (document.getElementById('autofill_' + key)) {\n          document.getElementById('autofill_' + key).innerHTML = params[key];\n        }\n      }\n    }\n  },\n  throwError: function throwError(msg) {\n    CD.miCaptureFallback(function () {\n      MICapture.error(msg);\n    }, function () {\n      CD.log('Capturama error: ' + msg);\n    });\n  },\n  cancelRequest: function cancelRequest(msg) {\n    CD.miCaptureFallback(function () {\n      MICapture.cancel(msg);\n    }, function () {\n      CD.log('Request canceled: ' + msg);\n    });\n  },\n  setImageRedirect: function setImageRedirect(imageUrl) {\n    var a = document.getElementById('mi-redirect-image') || document.createElement('a');\n\n    a.href = imageUrl;\n    a.id = 'mi-redirect-image';\n    a.style.display = 'none';\n\n    document.body.appendChild(a);\n\n    return a;\n  },\n  setClickthrough: function setClickthrough(url) {\n    var a = document.getElementById('mi_dynamic_link') || document.createElement('a');\n\n    a.href = url;\n    a.id = 'mi_dynamic_link';\n    a.style.display = 'none';\n\n    document.body.appendChild(a);\n\n    return a;\n  },\n  setExtraData: function setExtraData(dataObject) {\n    var el = document.getElementById('mi-data') || document.createElement('div');\n\n    el.id = 'mi-data';\n    el.style.display = 'none';\n\n    var existingData = void 0;\n    try {\n      existingData = JSON.parse(el.getAttribute('data-mi-data')) || {};\n    } catch (_) {\n      // Overwrite if there was something in mi-data that wasn't JSON\n      existingData = {};\n    }\n\n    for (var key in dataObject) {\n      if (dataObject.hasOwnProperty(key)) {\n        existingData[key] = dataObject[key];\n      }\n    }\n\n    el.setAttribute('data-mi-data', JSON.stringify(existingData));\n    document.body.appendChild(el);\n\n    return el;\n  },\n  proxyUrl: function proxyUrl(url) {\n    var a = document.createElement('a');\n    a.href = url;\n\n    var port = '';\n    if (a.port === '0' || a.port === '') {\n      port = a.protocol === 'https:' ? ':443' : '';\n    } else {\n      port = ':' + a.port;\n    }\n\n    var hostname = a.hostname,\n        pathname = a.pathname,\n        search = a.search,\n        hash = a.hash;\n\n    return CD.CORS_PROXY_SERVER + '/' + hostname + port + pathname + search + hash;\n  },\n\n\n  // internal, do not modify\n  _readyToCapture: true,\n\n  _reset: function _reset() {\n    CD._readyToCapture = true;\n  },\n  pause: function pause(maxSuspension) {\n    var msg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'manual suspension';\n\n    if (maxSuspension) {\n      msg += ', will end in ' + maxSuspension + 'ms';\n\n      setTimeout(function () {\n        CD.resume(msg);\n      }, maxSuspension);\n    }\n\n    CD.miCaptureFallback(function () {\n      MICapture.pause(msg);\n    }, function () {\n      CD.log('paused: ' + msg);\n    });\n  },\n  resume: function resume(msg) {\n    CD.miCaptureFallback(function () {\n      MICapture.resume(msg);\n    }, function () {\n      CD.log('resuming paused capture: ' + msg);\n    });\n  },\n  getCORS: function getCORS(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var callback = arguments[2];\n\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    options.corsCacheTime = options.corsCacheTime || 10 * 1000;\n    if (!/cors.movableink.com/.test(url)) {\n      url = CD.proxyUrl(url);\n    }\n\n    options.headers = options.headers || {};\n    options.headers['x-reverse-proxy-ttl'] = options.corsCacheTime / 1000;\n    options.headers['x-mi-cbe'] = this._hashForRequest(url, options);\n\n    return CD.get(url, options, callback);\n  },\n  get: function get(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var callback = arguments[2];\n\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    var deprecatedCallback = function deprecatedCallback() {\n      if (callback && typeof callback === 'function') {\n        CD.log(DEPRECATION_MSG);\n        return callback.apply(undefined, arguments);\n      }\n    };\n\n    var msg = 'xhr: ' + url;\n\n    return new Promise(function (resolve, reject) {\n      try {\n        var req = new XMLHttpRequest();\n\n        req.onerror = function () {\n          var error = 'XHR error for ' + url + ' - ' + this.status + ': ' + this.statusText;\n\n          CD.resume(msg);\n\n          deprecatedCallback(null);\n\n          reject(new Error(error));\n        };\n\n        req.onload = function () {\n          var contentType = this.getResponseHeader('content-type');\n          var data = this.responseText;\n          var status = this.status;\n\n          if (status >= 400) {\n            return this.onerror();\n          }\n\n          CD.resume(msg);\n\n          deprecatedCallback(data, status, contentType);\n\n          resolve({\n            contentType: contentType,\n            data: data,\n            status: status\n          });\n        };\n\n        req.open(options.method || 'GET', url, true);\n\n        req.withCredentials = !options.withoutCredentials;\n\n        if (options.headers) {\n          for (var header in options.headers) {\n            req.setRequestHeader(header, options.headers[header]);\n          }\n        }\n\n        req.send(options.body);\n        CD.pause(options.maxSuspension, msg);\n      } catch (error) {\n        deprecatedCallback(null);\n\n        reject({\n          message: 'Cropduster failed to create Promise: ' + error,\n          error: error\n        });\n      }\n    });\n  },\n  getImage: function getImage(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var callback = arguments[2];\n\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    var deprecatedCallback = function deprecatedCallback() {\n      if (callback && typeof callback === 'function') {\n        CD.log(DEPRECATION_MSG);\n\n        return callback.apply(undefined, arguments);\n      }\n    };\n\n    var msg = 'getImage: ' + url;\n\n    return new Promise(function (resolve, reject) {\n      var img = new Image();\n\n      img.onload = function () {\n        CD.resume(msg);\n\n        deprecatedCallback(img);\n\n        resolve(img);\n      };\n\n      img.onerror = function (event) {\n        CD.resume(msg);\n\n        deprecatedCallback(null);\n\n        reject(event);\n      };\n\n      CD.pause(options.maxSuspension, msg);\n      img.src = url;\n    });\n  },\n\n\n  /**\n   * NOTE: getImages is intended to be used with promises. The `afterAll` callback is\n   * now deprecated, and the order of the afterEach and afterAll arguments has\n   * been reversed since previous versions of cropduster.\n   *\n   * To achieve the same effect, users should pass a single callback into the\n   * arguments for getImages, and then use a `.then` call to handle any actions\n   * after all images have finished loading.\n   *\n   * If any image fails to load, the Promise will reject.\n   */\n  getImages: function getImages(urls) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var _this = this;\n\n    var afterEach = arguments[2];\n    var afterAll = arguments[3];\n\n    var msg = 'getImages:';\n    CD.pause(options.maxSuspension, msg);\n\n    if (typeof options === 'function') {\n      afterAll = afterEach;\n      afterEach = options;\n      options = {};\n    }\n\n    var promises = urls.map(function (url) {\n      return _this.getImage(url, options.maxSuspension).then(function (img) {\n        if (afterEach) {\n          afterEach(img);\n        }\n\n        return img;\n      });\n    });\n\n    return Promise.all(promises).then(function (images) {\n      if (afterAll) {\n        CD.log(DEPRECATION_MSG);\n        afterAll(images);\n      }\n\n      CD.resume(msg);\n      return images;\n    }, function (_) {\n      CD.resume(msg);\n      throw new Error('Not all images loaded successfully');\n    });\n  },\n  waitForAsset: function waitForAsset(assetUrl) {\n    CD.miCaptureFallback(function () {\n      MICapture.waitForAsset(assetUrl);\n    }, function () {\n      CD.log('Wait for asset: ' + assetUrl);\n    });\n  },\n  log: function log(message) {\n    console.log(message);\n  },\n  miCaptureFallback: function miCaptureFallback(ifCapturama, ifBrowser) {\n    var loadedInCapturama = !!window.MICapture && _typeof(window.MICapture) === 'object';\n    return loadedInCapturama ? ifCapturama() : ifBrowser();\n  },\n  _hashForRequest: function _hashForRequest(url, options) {\n    var str = '' + url + JSON.stringify(options);\n\n    var hash = 0;\n    if (str.length === 0) return hash;\n\n    for (var i = 0; i < str.length; i++) {\n      hash = (hash << 5) - hash + str.charCodeAt(i) & 0xffffffff;\n    }\n\n    return hash.toString();\n  }\n};\n\nexports.default = CD;\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// cropduster.browser.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 13b9ee4e72a56a8bdc81","const DEPRECATION_MSG = 'callbacks are deprecated in cropduster, prefer using promises for asynchronous operations';\n\nconst CD = {\n  CORS_PROXY_SERVER: 'http://cors.movableink.com',\n\n  $(selector, doc) {\n    if (!doc) {\n      doc = document;\n    }\n\n    return [...doc.querySelectorAll(selector)];\n  },\n\n  _initParams() {\n    CD._urlParams = {};\n    const search = /([^&=]+)=?([^&]*)/g;\n    const query = CD._searchString();\n\n    let match = search.exec(query);\n    while (match) {\n      CD._urlParams[decodeURIComponent(match[1])] = decodeURIComponent(match[2]);\n      match = search.exec(query);\n    }\n  },\n\n  param(name) {\n    return CD.params()[name];\n  },\n\n  params(name) {\n    let params = CD._urlParams;\n    if (typeof params === 'undefined') {\n      CD._initParams();\n      params = CD._urlParams;\n    }\n\n    if (name) {\n      return params[name];\n    } else {\n      return params;\n    }\n  },\n\n  _searchString() {\n    return window.location.search.substring(1);\n  },\n\n  autofill() {\n    CD.param('init'); // inits CD._urlParams\n    const params = CD._urlParams;\n    for (const key in params) {\n      if (params[key] !== 'undefined' && params[key].length > 0) {\n        if (document.getElementById(`autofill_${key}`)) {\n          document.getElementById(`autofill_${key}`).innerHTML = params[key];\n        }\n      }\n    }\n  },\n\n  throwError(msg) {\n    CD.miCaptureFallback(\n      () => { MICapture.error(msg); },\n      () => { CD.log('Capturama error: ' + msg) }\n    );\n  },\n\n  cancelRequest(msg) {\n    CD.miCaptureFallback(\n      () => { MICapture.cancel(msg); },\n      () => { CD.log(`Request canceled: ${msg}`); }\n    );\n  },\n\n  setImageRedirect(imageUrl) {\n    const a = document.getElementById('mi-redirect-image') || document.createElement('a');\n\n    a.href = imageUrl;\n    a.id = 'mi-redirect-image';\n    a.style.display = 'none';\n\n    document.body.appendChild(a);\n\n    return a;\n  },\n\n  setClickthrough(url) {\n    const a = document.getElementById('mi_dynamic_link') || document.createElement('a');\n\n    a.href = url;\n    a.id = 'mi_dynamic_link';\n    a.style.display = 'none';\n\n    document.body.appendChild(a);\n\n    return a;\n  },\n\n  setExtraData(dataObject) {\n    const el = document.getElementById('mi-data') || document.createElement('div');\n\n    el.id = 'mi-data';\n    el.style.display = 'none';\n\n    let existingData;\n    try {\n      existingData = JSON.parse(el.getAttribute('data-mi-data')) || {};\n    } catch (_) {\n      // Overwrite if there was something in mi-data that wasn't JSON\n      existingData = {};\n    }\n\n    for (const key in dataObject) {\n      if (dataObject.hasOwnProperty(key)) {\n        existingData[key] = dataObject[key];\n      }\n    }\n\n    el.setAttribute('data-mi-data', JSON.stringify(existingData));\n    document.body.appendChild(el);\n\n    return el;\n  },\n\n  proxyUrl(url) {\n    const a = document.createElement('a');\n    a.href = url;\n\n    let port = '';\n    if (a.port === '0' || a.port === '') {\n      port = a.protocol === 'https:' ? ':443' : '';\n    } else {\n      port = `:${a.port}`;\n    }\n\n    const { hostname, pathname, search, hash } = a;\n    return `${CD.CORS_PROXY_SERVER}/${hostname}${port}${pathname}${search}${hash}`;\n  },\n\n  // internal, do not modify\n  _readyToCapture: true,\n\n  _reset() {\n    CD._readyToCapture = true;\n  },\n\n  pause(maxSuspension, msg = 'manual suspension') {\n    if (maxSuspension) {\n      msg += `, will end in ${maxSuspension}ms`;\n\n      setTimeout(() => {\n        CD.resume(msg);\n      }, maxSuspension);\n    }\n\n    CD.miCaptureFallback(\n      () => { MICapture.pause(msg) },\n      () => { CD.log(`paused: ${msg}`) }\n    );\n  },\n\n  resume(msg) {\n    CD.miCaptureFallback(\n      () => { MICapture.resume(msg) },\n      () => { CD.log(`resuming paused capture: ${msg}`)}\n    );\n  },\n\n  getCORS(url, options = {}, callback) {\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    options.corsCacheTime = options.corsCacheTime || 10 * 1000;\n    if (!/cors.movableink.com/.test(url)) {\n      url = CD.proxyUrl(url);\n    }\n\n    options.headers = options.headers || {};\n    options.headers['x-reverse-proxy-ttl'] = options.corsCacheTime / 1000;\n    options.headers['x-mi-cbe'] = this._hashForRequest(url, options);\n\n    return CD.get(url, options, callback);\n  },\n\n  get(url, options = {}, callback) {\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    const deprecatedCallback = function() {\n      if (callback && typeof callback === 'function') {\n        CD.log(DEPRECATION_MSG);\n        return callback(...arguments);\n      }\n    };\n\n    const msg = `xhr: ${url}`;\n\n    return new Promise(function(resolve, reject) {\n      try {\n        const req = new XMLHttpRequest();\n\n        req.onerror = function() {\n          const error = `XHR error for ${url} - ${this.status}: ${this.statusText}`;\n\n          CD.resume(msg);\n\n          deprecatedCallback(null);\n\n          reject(new Error(error));\n        };\n\n        req.onload = function() {\n          const contentType = this.getResponseHeader('content-type');\n          const data = this.responseText;\n          const status = this.status;\n\n          if (status >= 400) {\n            return this.onerror();\n          }\n\n          CD.resume(msg);\n\n          deprecatedCallback(data, status, contentType);\n\n          resolve({\n            contentType,\n            data,\n            status\n          });\n        };\n\n        req.open(options.method || 'GET', url, true);\n\n        req.withCredentials = !options.withoutCredentials;\n\n        if (options.headers) {\n          for (const header in options.headers) {\n            req.setRequestHeader(header, options.headers[header]);\n          }\n        }\n\n        req.send(options.body);\n        CD.pause(options.maxSuspension, msg);\n      } catch (error) {\n        deprecatedCallback(null);\n\n        reject({\n          message: `Cropduster failed to create Promise: ${error}`,\n          error: error\n        });\n      }\n    });\n  },\n\n  getImage(url, options = {}, callback) {\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    const deprecatedCallback = function() {\n      if (callback && typeof callback === 'function') {\n        CD.log(DEPRECATION_MSG);\n\n        return callback(...arguments);\n      }\n    };\n\n    const msg = `getImage: ${url}`;\n\n    return new Promise(function(resolve, reject) {\n      const img = new Image();\n\n      img.onload = function() {\n        CD.resume(msg);\n\n        deprecatedCallback(img);\n\n        resolve(img);\n      };\n\n      img.onerror = function(event) {\n        CD.resume(msg);\n\n        deprecatedCallback(null);\n\n        reject(event);\n      };\n\n      CD.pause(options.maxSuspension, msg);\n      img.src = url;\n    });\n  },\n\n  /**\n   * NOTE: getImages is intended to be used with promises. The `afterAll` callback is\n   * now deprecated, and the order of the afterEach and afterAll arguments has\n   * been reversed since previous versions of cropduster.\n   *\n   * To achieve the same effect, users should pass a single callback into the\n   * arguments for getImages, and then use a `.then` call to handle any actions\n   * after all images have finished loading.\n   *\n   * If any image fails to load, the Promise will reject.\n   */\n  getImages(urls, options = {}, afterEach, afterAll) {\n    const msg = 'getImages:';\n    CD.pause(options.maxSuspension, msg);\n\n    if (typeof options === 'function') {\n      afterAll = afterEach;\n      afterEach = options;\n      options = {};\n    }\n\n    const promises = urls.map(url => {\n      return this.getImage(url, options.maxSuspension).then(img => {\n        if (afterEach) {\n          afterEach(img);\n        }\n\n        return img;\n      });\n    });\n\n    return Promise.all(promises).then(\n      images => {\n        if (afterAll) {\n          CD.log(DEPRECATION_MSG);\n          afterAll(images);\n        }\n\n        CD.resume(msg);\n        return images;\n      },\n      _ => {\n        CD.resume(msg);\n        throw new Error('Not all images loaded successfully');\n      });\n  },\n\n  waitForAsset(assetUrl) {\n    CD.miCaptureFallback(\n      () => { MICapture.waitForAsset(assetUrl); },\n      () => { CD.log(`Wait for asset: ${assetUrl}`); }\n    );\n  },\n\n  log(message) {\n    console.log(message);\n  },\n\n  miCaptureFallback(ifCapturama, ifBrowser) {\n    const loadedInCapturama = !!window.MICapture && typeof window.MICapture === 'object';\n    return loadedInCapturama ? ifCapturama() : ifBrowser();\n  },\n\n  _hashForRequest(url, options) {\n    const str = `${url}${JSON.stringify(options)}`;\n\n    let hash = 0;\n    if (str.length === 0) return hash;\n\n    for (let i = 0; i < str.length; i++) {\n      hash = ((hash << 5) - hash + str.charCodeAt(i)) & 0xffffffff;\n    }\n\n    return hash.toString();\n  }\n};\n\nexport default CD;\n\n\n\n// WEBPACK FOOTER //\n// ./src/cropduster.js"],"sourceRoot":""}